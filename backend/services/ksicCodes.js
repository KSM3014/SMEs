/**
 * KSIC (Korean Standard Industry Classification) Code-to-Name Mapping
 * 한국표준산업분류 코드 → 업종명 매핑
 *
 * Source: Statistics Korea (통계청) KSIC 10th revision
 * Coverage: ~300 codes commonly found in SME/DART data
 */

const KSIC_CODES = new Map([
  // A. 농업, 임업 및 어업
  ['01', '농업'], ['02', '임업'], ['03', '어업'],

  // B. 광업
  ['05', '석탄, 원유 및 천연가스 광업'], ['07', '금속 광업'], ['08', '비금속광물 광업'],

  // C. 제조업
  ['10', '식료품 제조업'], ['1010', '도축, 육류 가공 및 저장 처리업'],
  ['1020', '수산물 가공 및 저장 처리업'], ['1030', '과실, 채소 가공 및 저장 처리업'],
  ['1040', '동물성 및 식물성 유지 제조업'], ['1050', '낙농제품 및 식용빙과류 제조업'],
  ['1061', '곡물 도정업'], ['1071', '떡, 빵 및 과자류 제조업'],
  ['1080', '동물용 사료 및 조제식품 제조업'], ['1090', '기타 식품 제조업'],
  ['11', '음료 제조업'], ['1110', '알코올음료 제조업'], ['1120', '비알코올음료 및 얼음 제조업'],
  ['12', '담배 제조업'],
  ['13', '섬유제품 제조업; 의복제외'], ['1311', '방적 및 가공사 제조업'],
  ['14', '의복, 의복액세서리 및 모피제품 제조업'], ['1411', '정장 의복 제조업'],
  ['15', '가죽, 가방 및 신발 제조업'],
  ['16', '목재 및 나무제품 제조업; 가구제외'],
  ['17', '펄프, 종이 및 종이제품 제조업'], ['1710', '펄프 제조업'], ['1720', '골판지, 종이 상자 및 종이용기 제조업'],
  ['18', '인쇄 및 기록매체 복제업'], ['1811', '경인쇄업'],
  ['19', '코크스, 연탄 및 석유정제품 제조업'], ['1910', '코크스 및 연탄 제조업'], ['1920', '석유정제품 제조업'],
  ['20', '화학물질 및 화학제품 제조업; 의약품제외'],
  ['2011', '기초 유기화학물질 제조업'], ['2012', '기초 무기화학물질 제조업'],
  ['2021', '합성수지 및 기타 플라스틱물질 제조업'], ['2022', '합성고무 및 기타 탄성중합체 제조업'],
  ['2030', '비료 및 질소화합물 제조업'], ['2041', '살충제 및 기타 농약 제조업'],
  ['2042', '페인트, 잉크 및 유사제품 제조업'], ['2049', '그 외 기타 화학제품 제조업'],
  ['2051', '화장품 제조업'], ['2052', '치약, 비누 및 기타 세제 제조업'],
  ['21', '의료용 물질 및 의약품 제조업'],
  ['2110', '기초 의약물질 및 생물학적 제제 제조업'], ['2120', '의약품 제조업'],
  ['2130', '의료용품 및 기타 의약 관련제품 제조업'],
  ['22', '고무제품 및 플라스틱제품 제조업'],
  ['2211', '타이어 및 튜브 제조업'], ['2219', '기타 고무제품 제조업'],
  ['2220', '플라스틱제품 제조업'], ['2221', '1차 플라스틱제품 제조업'],
  ['2229', '기타 플라스틱제품 제조업'],
  ['23', '비금속 광물제품 제조업'],
  ['2311', '판유리 제조업'], ['2312', '판유리 가공품 제조업'],
  ['2320', '도자기 및 기타 요업제품 제조업'], ['2330', '시멘트, 석회, 플라스터 및 그 제품 제조업'],
  ['24', '1차 금속 제조업'],
  ['2411', '제철업'], ['2412', '제강업'], ['2421', '동 제련, 정련 및 합금 제조업'],
  ['2431', '철강 주조업'], ['2432', '비철금속 주조업'],
  ['25', '금속가공제품 제조업; 기계 및 가구제외'],
  ['2511', '구조용 금속제품 제조업'], ['2512', '금속 탱크, 저장조 및 유사 용기 제조업'],
  ['2521', '증기발생기 제조업'], ['2591', '금속 단조, 압형 및 분말야금 제품 제조업'],
  ['2592', '금속 열처리, 도금 및 기타 금속 가공업'], ['2599', '그 외 기타 금속가공제품 제조업'],
  ['26', '전자부품, 컴퓨터, 영상, 음향 및 통신장비 제조업'],
  ['2611', '메모리용 전자집적회로 제조업'], ['2612', '비메모리용 및 기타 전자집적회로 제조업'],
  ['2619', '기타 전자부품 제조업'],
  ['2621', '컴퓨터 제조업'], ['2622', '기억장치 제조업'], ['2629', '기타 컴퓨터 주변기기 제조업'],
  ['2631', '유선 통신장비 제조업'], ['2632', '방송 및 무선 통신장비 제조업'],
  ['2641', '텔레비전 제조업'], ['2649', '비디오 및 기타 영상기기 제조업'],
  ['2651', '계측, 시험, 항해 및 기타 정밀기기 제조업'],
  ['2652', '자동 측정 및 제어장치 제조업'],
  ['26110', '전자집적회로 제조업'],
  ['26112', '전기식 진단 및 요법 기기 제조업'],
  ['26410', '유선 통신장비 제조업'],
  ['26429', '기타 영상 및 음향기기 제조업'],
  ['26519', '기타 측정, 시험, 항해 및 제어 장비 제조업'],
  ['27', '의료, 정밀, 광학기기 및 시계 제조업'],
  ['2710', '의료용 기기 제조업'], ['2711', '방사선 장치 제조업'],
  ['2712', '전기식 진단 및 요법 기기 제조업'], ['2719', '기타 의료용 기기 제조업'],
  ['2720', '측정, 시험, 항해, 제어 및 기타 정밀기기 제조업'],
  ['2731', '안경 제조업'], ['2732', '사진기, 영사기 및 관련 장비 제조업'],
  ['27112', '전기식 진단 및 요법 기기 제조업'],
  ['28', '전기장비 제조업'],
  ['2811', '전동기 및 발전기 제조업'], ['2812', '변압기, 변성기 및 유사장비 제조업'],
  ['2821', '일차전지 제조업'], ['2822', '축전지 제조업'],
  ['2824', '태양전지 제조업'],
  ['2831', '절연선 및 케이블 제조업'],
  ['2841', '전구 및 조명장치 제조업'],
  ['2851', '가정용 전기 냉장고, 냉동고 및 냉온정수기 제조업'],
  ['2852', '가정용 전기 세탁기 제조업'],
  ['29', '기타 기계 및 장비 제조업'],
  ['2911', '내연기관 제조업'], ['2912', '유압기기 제조업'],
  ['2921', '산업용 오븐, 노 및 노용 버너 제조업'],
  ['2922', '산업용 트럭, 승강기 및 물품 취급장비 제조업'],
  ['2924', '반도체 제조용 기계 제조업'],
  ['2929', '기타 특수 목적용 기계 제조업'],
  ['2930', '일반 목적용 기계 제조업'],
  ['30', '자동차 및 트레일러 제조업'],
  ['3010', '자동차용 엔진 및 자동차 제조업'], ['3011', '승용차 및 기타 여객용 자동차 제조업'],
  ['3020', '자동차 차체 및 트레일러 제조업'], ['3030', '자동차 부품 제조업'],
  ['3031', '자동차 엔진용 부품 제조업'], ['3032', '자동차 전기, 전자 장치 제조업'],
  ['3039', '기타 자동차 부품 제조업'],
  ['31', '기타 운송장비 제조업'],
  ['3111', '강선 건조업'], ['3112', '합성수지선 건조업'],
  ['3120', '철도장비 제조업'], ['3130', '항공기, 우주선 및 보조장치 제조업'],
  ['32', '가구 제조업'], ['3201', '목재 가구 제조업'], ['3202', '금속 가구 제조업'],
  ['33', '기타 제품 제조업'],
  ['3311', '귀금속 및 관련제품 제조업'], ['3312', '악기 제조업'],
  ['3320', '산업용 기계 및 장비 수리업'],

  // D. 전기, 가스, 증기 및 공기조절 공급업
  ['35', '전기, 가스, 증기 및 공기조절 공급업'],
  ['3511', '발전업'], ['3512', '송전 및 배전업'], ['3530', '증기, 냉온수 및 공기조절 공급업'],

  // E. 수도, 하수 및 폐기물 처리, 원료 재생업
  ['36', '수도업'], ['37', '하수, 폐수 및 분뇨 처리업'], ['38', '폐기물 수집, 운반, 처리 및 원료 재생업'],

  // F. 건설업
  ['41', '종합 건설업'], ['4111', '주거용 건물 건설업'], ['4112', '비주거용 건물 건설업'],
  ['42', '전문직별 공사업'], ['4210', '기반조성 및 시설물 축조관련 전문공사업'],

  // G. 도매 및 소매업
  ['45', '자동차 및 부품 판매업'],
  ['46', '도매 및 상품 중개업'],
  ['4610', '상품 종합 도매업'], ['4621', '곡물 및 종자류 도매업'],
  ['4641', '섬유 및 직물 도매업'], ['4651', '컴퓨터 및 주변기기, 소프트웨어 도매업'],
  ['4659', '기타 기계장비 도매업'], ['4691', '상품 종합 도매업'],
  ['47', '소매업; 자동차 제외'],
  ['4711', '종합 소매업'], ['4712', '체인화 편의점'],
  ['4721', '건강보조식품 소매업'],

  // H. 운수 및 창고업
  ['49', '육상 운송 및 파이프라인 운송업'],
  ['50', '수상 운송업'], ['51', '항공 운송업'], ['52', '창고 및 운송관련 서비스업'],

  // I. 숙박 및 음식점업
  ['55', '숙박업'], ['56', '음식점 및 주점업'],

  // J. 정보통신업
  ['58', '출판업'],
  ['5812', '신문, 잡지 및 정기 간행물 발행업'], ['5821', '게임 소프트웨어 개발 및 공급업'],
  ['5822', '시스템, 응용 소프트웨어 개발 및 공급업'],
  ['59', '영상, 오디오 기록물 제작 및 배급업'],
  ['5911', '영화, 비디오물 및 방송프로그램 제작업'],
  ['60', '방송업'], ['6010', '라디오 방송업'], ['6021', '텔레비전 방송업'],
  ['61', '우편 및 통신업'],
  ['6110', '유선 통신업'], ['6120', '무선 통신업'], ['6130', '기타 전기 통신업'],
  ['62', '컴퓨터 프로그래밍, 시스템 통합 및 관리업'],
  ['6201', '컴퓨터 프로그래밍 서비스업'], ['62010', '컴퓨터 프로그래밍 서비스업'],
  ['6202', '컴퓨터시스템 통합 자문 및 구축 서비스업'], ['62021', '컴퓨터시스템 통합 자문 및 구축 서비스업'],
  ['6209', '기타 정보기술 및 컴퓨터 운영 관련 서비스업'],
  ['63', '정보서비스업'],
  ['6311', '자료 처리업'], ['6312', '호스팅 및 관련 서비스업'],
  ['6391', '뉴스 제공업'], ['6399', '그 외 기타 정보 서비스업'],

  // K. 금융 및 보험업
  ['64', '금융업'],
  ['6411', '중앙은행'], ['6412', '일반 은행'], ['6420', '신탁업 및 집합투자업'],
  ['6430', '연금 및 공제업'], ['6491', '여신전문 금융업'], ['6492', '기타 금융업'],
  ['64920', '기타 금융업'],
  ['65', '보험 및 연금업'],
  ['6510', '보험업'], ['6520', '재보험업'],
  ['66', '금융 및 보험 관련 서비스업'],
  ['6611', '금융시장 관리업'], ['6612', '증권 및 선물 중개업'],
  ['6619', '기타 금융 지원 서비스업'], ['6621', '손해사정업'],

  // L. 부동산업
  ['68', '부동산업'],
  ['6810', '부동산 임대 및 공급업'], ['6820', '부동산 관련 서비스업'],
  ['6821', '부동산 중개 및 감정업'],

  // M. 전문, 과학 및 기술 서비스업
  ['70', '연구개발업'],
  ['7010', '자연과학 및 공학 연구개발업'], ['7020', '인문 및 사회과학 연구개발업'],
  ['70101', '물리, 화학 및 생물학 연구개발업'], ['70102', '농림수산학 연구개발업'],
  ['70103', '의학 및 약학 연구개발업'], ['70109', '기타 자연과학 연구개발업'],
  ['71', '전문 서비스업'],
  ['7111', '법무 관련 서비스업'], ['7112', '회계 및 세무 관련 서비스업'],
  ['7120', '건축기술, 엔지니어링 및 기타 과학기술 서비스업'],
  ['7121', '건축설계 및 관련 서비스업'], ['7129', '기타 엔지니어링 서비스업'],
  ['7130', '기타 전문 서비스업'],
  ['72', '건축기술, 엔지니어링 및 기타 과학기술 서비스업'],
  ['73', '기타 전문, 과학 및 기술 서비스업'],
  ['7310', '수의업'], ['7320', '전문 디자인업'],
  ['7340', '광고업'], ['7390', '기타 전문, 과학 및 기술 서비스업'],

  // N. 사업시설 관리, 사업 지원 및 임대 서비스업
  ['74', '사업시설 관리 및 조경 서비스업'],
  ['75', '사업 지원 서비스업'],
  ['7511', '고용 알선업'], ['7512', '인력 공급업'],
  ['76', '임대업; 부동산 제외'],

  // P. 교육 서비스업
  ['85', '교육 서비스업'],
  ['8521', '일반 교과 학원'], ['8522', '기타 기술 및 직업훈련 학원'],

  // Q. 보건업 및 사회복지 서비스업
  ['86', '보건업'],
  ['8610', '병원'], ['8620', '의원'],
  ['87', '사회복지 서비스업'],

  // R. 예술, 스포츠 및 여가관련 서비스업
  ['90', '창작, 예술 및 여가관련 서비스업'],
  ['91', '스포츠 및 오락관련 서비스업'],

  // S. 협회 및 단체, 수리 및 기타 개인 서비스업
  ['94', '협회 및 단체'], ['95', '수리업'], ['96', '기타 개인 서비스업'],
]);

/**
 * Resolve industry code to name.
 * Tries exact match first, then 4-digit, 3-digit, 2-digit prefixes.
 * @param {string|number} code
 * @returns {string|null}
 */
export function resolveIndustryName(code) {
  if (!code) return null;
  const s = String(code).trim();
  if (!s) return null;

  // Exact match
  if (KSIC_CODES.has(s)) return KSIC_CODES.get(s);
  // Try shorter prefixes
  for (let len = Math.min(s.length - 1, 4); len >= 2; len--) {
    const prefix = s.slice(0, len);
    if (KSIC_CODES.has(prefix)) return KSIC_CODES.get(prefix);
  }
  return null;
}

export { KSIC_CODES };
